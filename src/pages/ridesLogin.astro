---
import ButtonDark from "../components/Button/ButtonDark.astro";
import MainLayout from "../layouts/MainLayout.astro";
import Logout from "../components/Auth/LogoutState.astro";
import RideCard from "../components/Rides/RideCard.astro";
import RideCardOthers from "../components/Rides/RideCardOthers.astro";
import Divider from "../components/Divider/Divider.astro"
import DividerRides from "../components/Divider/DividerRides.astro"

//Getting cookies data
const userId = Astro.cookies.get("userId")?.value;

const response1 = await fetch(import.meta.env.PUBLIC_BACKEND_URL+"/api/user/get-user", {credentials: "include"});
const data1 = await response1.json();
console.log(data1.userId);


//Listing all rides
const response = await fetch(import.meta.env.PUBLIC_BACKEND_URL+"/api/rides/list-all");
const data = await response.json();
const rides = data.rides;

//Listing logged in user ride
const response2 = await fetch(import.meta.env.PUBLIC_BACKEND_URL+'/api/rides/list-user-rides', 
                { method: 'POST', 
                headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json'
                },
                body : JSON.stringify({ id: userId })});
//console.log(response2.json())
const data2 = await response2.json();
//console.log(data2.rides)
const userRides = data2.userRides;
const otherRides = data2.otherRides;


---
<MainLayout title="User Rides" description="Page to show all user rides.">
    <div class="mt-25 md:mt-40 ml-5 mr-5 md:ml-20 md:mr-20">

        <Logout />

       {userRides.length >= 1 && ( <DividerRides title={"MY RIDES"} />)}

        <div class="ride-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 mt-8 mb-20">
            <RideCard allRides={userRides}/>            
        </div>
        
        {otherRides.length >= 1 && ( <DividerRides title={"ALL RIDES"} /> )}

        <div class="ride-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 mt-8">
            <RideCardOthers allRides={otherRides}/>          
        </div>
    </div>
</MainLayout>



<style>
@media screen and (min-width: 1024px) and (max-width: 1366px) {
  .ride-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
  }
}
</style>


